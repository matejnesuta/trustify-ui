"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["899"],{85790:function(e,t,l){l.d(t,{a:()=>a});var i=l(62540),r=l(69548);let a=e=>{let{value:t}=e;return(0,i.jsx)(i.Fragment,{children:Object.entries(t).map(e=>{let[t,l]=e;return(0,i.jsx)(r.J,{isCompact:!0,children:"".concat(t,"=").concat(l)},"".concat(t,"=").concat(l))})})}},35913:function(e,t,l){l.d(t,{$:()=>d});var i=l(32909),r=l(42642),a=l(63696),n=l(27875),s=l(33468);let u=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,o={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:(0,i._)({},o),fixed:(0,i._)({},o),not_affected:(0,i._)({},o),known_not_affected:(0,i._)({},o),under_investigation:(0,i._)({},o)}},d=e=>{let{pkg:t,isFetching:l,fetchError:o}=(0,s.Si)(e);return{data:a.useMemo(()=>{let e,l;return l=(e=((null==t?void 0:t.advisories)||[]).flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>{let l=(0,n.U)(t.average_severity);return{vulnerability:(0,r._)((0,i._)({},t.vulnerability),{average_severity:l,average_score:t.average_score}),vulnerabilityStatus:t.status,advisory:e}})}).reduce((e,t)=>{let l,a=e.find(e=>u(e,t));if(a)l=[...e.filter(e=>!u(e,a)),(0,r._)((0,i._)({},a),{relatedSboms:[...a.relatedSboms,{advisory:t.advisory}]})];else{let i={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};l=[...e.slice(),i]}return l},[])).reduce((e,t)=>{let l=t.vulnerabilityStatus,a=t.vulnerability.average_severity,n=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,r._)((0,i._)({},e.vulnerabilityStatus),{[l]:{total:n.total+1,severities:(0,r._)((0,i._)({},n.severities),{[a]:n.severities[a]+1})}})})},(0,i._)({},c)),{vulnerabilities:e,summary:l}},[t]),isFetching:l,fetchError:o}}},55178:function(e,t,l){l.d(t,{H:()=>o});var i=l(62540),r=l(6160),a=l(24296),n=l(92107),s=l(15461),u=l(35913);let o=e=>{let{packageId:t}=e,{data:l,isFetching:o,fetchError:c}=(0,u.$)(t);return(0,i.jsx)(a.a,{isFetching:o,fetchError:c,isFetchingState:(0,i.jsx)(r.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,i.jsx)(n.D,{error:e}),children:(0,i.jsx)(s.n,{severities:l.summary.vulnerabilityStatus.affected.severities})})}},13701:function(e,t,l){l.d(t,{Y:()=>d,a:()=>v});var i=l(32909),r=l(42642),a=l(62540),n=l(63696),s=l(98259);l(1480);var u=l(73470),o=l(33468),c=l(23909);let d=n.createContext({}),v=e=>{let{children:t}=e,l=(0,u.MM)({tableName:"packages",persistenceKeyPrefix:s.rt.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:s._G,title:"Filter text",placeholderText:"Search",type:"search"},{categoryKey:"type",title:"Type",placeholderText:"Type",type:"multiselect",selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:"multiselect",selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:v,total:p},isFetching:h,fetchError:m}=(0,o.Lx)((0,u.Ng)((0,r._)((0,i._)({},l),{hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}}))),y=n.useMemo(()=>v.map(e=>(0,r._)((0,i._)({},e),{decomposedPurl:(0,c.fe)(e.purl)})),[v]),_=(0,u.PB)((0,r._)((0,i._)({},l),{idProperty:"uuid",currentPageItems:y,totalItemCount:p,isLoading:h}));return(0,a.jsx)(d.Provider,{value:{totalItemCount:p,isFetching:h,fetchError:m,tableControls:_},children:t})}},51888:function(e,t,l){l.d(t,{N:()=>f});var i=l(32909),r=l(42642),a=l(62540),n=l(63696),s=l(74343),u=l(26917),o=l(16646),c=l(21758),d=l(40384),v=l(28516),p=l(78517),h=l(85790),m=l(93826),y=l(30448),_=l(52362),b=l(55178),x=l(13701);let f=()=>{let{isFetching:e,fetchError:t,totalItemCount:l,tableControls:f}=n.useContext(x.Y),{numRenderedColumns:g,currentPageItems:j,propHelpers:{paginationProps:P,tableProps:T,getThProps:S,getTrProps:k,getTdProps:K}}=f;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u.X,(0,r._)((0,i._)({},T),{"aria-label":"Package table",children:[(0,a.jsx)(o.d,{children:(0,a.jsx)(c.Tr,{children:(0,a.jsxs)(y.Ze,(0,r._)((0,i._)({},f),{children:[(0,a.jsx)(d.Th,(0,i._)({},S({columnKey:"name"}))),(0,a.jsx)(d.Th,(0,i._)({},S({columnKey:"namespace"}))),(0,a.jsx)(d.Th,(0,i._)({},S({columnKey:"version"}))),(0,a.jsx)(d.Th,(0,i._)({},S({columnKey:"type"}))),(0,a.jsx)(d.Th,(0,i._)({},S({columnKey:"path"}))),(0,a.jsx)(d.Th,(0,i._)({},S({columnKey:"qualifiers"}))),(0,a.jsx)(d.Th,(0,i._)({},S({columnKey:"vulnerabilities"})))]}))})}),(0,a.jsx)(y.nJ,{isLoading:e,isError:!!t,isNoData:0===l,numRenderedColumns:g,children:j.map((e,t)=>{var l,n,u,o,d,m,x;return(0,a.jsx)(v.N,{children:(0,a.jsx)(c.Tr,(0,r._)((0,i._)({},k({item:e})),{children:(0,a.jsxs)(y.Oi,(0,r._)((0,i._)({},f),{item:e,rowIndex:t,children:[(0,a.jsx)(p.Td,(0,r._)((0,i._)({width:15,modifier:"breakWord"},K({columnKey:"name"})),{children:(0,a.jsx)(s.k2,{to:(0,s.tW)(_.Jh.packageDetails,{packageId:e.uuid}),children:e.decomposedPurl?null==(l=e.decomposedPurl)?void 0:l.name:e.purl})})),(0,a.jsx)(p.Td,(0,r._)((0,i._)({width:15,modifier:"truncate"},K({columnKey:"namespace"})),{children:null==(n=e.decomposedPurl)?void 0:n.namespace})),(0,a.jsx)(p.Td,(0,r._)((0,i._)({width:10,modifier:"truncate"},K({columnKey:"version"})),{children:null==(u=e.decomposedPurl)?void 0:u.version})),(0,a.jsx)(p.Td,(0,r._)((0,i._)({width:10,modifier:"truncate"},K({columnKey:"type"})),{children:null==(o=e.decomposedPurl)?void 0:o.type})),(0,a.jsx)(p.Td,(0,r._)((0,i._)({width:10,modifier:"truncate"},K({columnKey:"path"})),{children:null==(d=e.decomposedPurl)?void 0:d.path})),(0,a.jsx)(p.Td,(0,r._)((0,i._)({width:20},K({columnKey:"qualifiers"})),{children:(null==(m=e.decomposedPurl)?void 0:m.qualifiers)&&(0,a.jsx)(h.a,{value:null==(x=e.decomposedPurl)?void 0:x.qualifiers})})),(0,a.jsx)(p.Td,(0,r._)((0,i._)({width:20},K({columnKey:"vulnerabilities"})),{children:(0,a.jsx)(b.H,{packageId:e.uuid})}))]}))}))},e.uuid)})})]})),(0,a.jsx)(m.n,{idPrefix:"package-table",isTop:!1,paginationProps:P})]})}},22549:function(e,t,l){l.d(t,{I:()=>p});var i=l(32909),r=l(42642),a=l(62540),n=l(63696),s=l(61360),u=l(35048),o=l(32490),c=l(1480),d=l(93826),v=l(13701);let p=e=>{let{showFilters:t}=e,{tableControls:l}=n.useContext(v.Y),{propHelpers:{toolbarProps:p,filterToolbarProps:h,paginationToolbarItemProps:m,paginationProps:y}}=l;return(0,a.jsx)(s.M,(0,r._)((0,i._)({},p),{"aria-label":"package-toolbar",children:(0,a.jsxs)(u.P,{children:[t&&(0,a.jsx)(c.Us,(0,i._)({},h)),(0,a.jsx)(o.T,(0,r._)((0,i._)({},m),{children:(0,a.jsx)(d.n,{idPrefix:"package-table",isTop:!0,paginationProps:y})}))]})}))}},33468:function(e,t,l){l.d(t,{Lx:()=>o,Si:()=>c,sl:()=>d});var i=l(32909),r=l(77184),a=l(96002),n=l(86141),s=l(73470);let u="packages",o=function(){var e,t,l;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:d,isLoading:v,error:p,refetch:h}=(0,r.I)({queryKey:[u,o],queryFn:()=>(0,n.UD)({client:a.S,query:(0,i._)({},(0,s.kd)(o))}),enabled:!c});return{result:{data:(null==d||null==(e=d.data)?void 0:e.items)||[],total:null!=(l=null==d||null==(t=d.data)?void 0:t.total)?l:0,params:o},isFetching:v,fetchError:p,refetch:h}},c=e=>{let{data:t,isLoading:l,error:i}=(0,r.I)({queryKey:[u,e],queryFn:()=>(0,n.Y0)({client:a.S,path:{key:e}})});return{pkg:null==t?void 0:t.data,isFetching:l,fetchError:i}},d=function(e){var t,l,o;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d,isLoading:v,error:p,refetch:h}=(0,r.I)({queryKey:[u,"by-sbom",e,c],queryFn:()=>(0,n.Ad)({client:a.S,path:{id:e},query:(0,i._)({},(0,s.kd)(c))})});return{result:{data:(null==d||null==(t=d.data)?void 0:t.items)||[],total:null!=(o=null==d||null==(l=d.data)?void 0:l.total)?o:0,params:c},isFetching:v,fetchError:p,refetch:h}}}}]);