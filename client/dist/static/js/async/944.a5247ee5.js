"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["944"],{97339:function(e,i,n){n.d(i,{a:()=>c});var r=n(59390),t=n(24246),l=n(27378),s=n(90633),a=n(15508),d=n(53315);let c=e=>{var{children:i=null,className:n="","aria-label":o="Breadcrumb",ouiaId:u,ouiaSafe:h=!0}=e,x=(0,r.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let j=(0,d.S$)(c.displayName,u,h);return(0,t.jsx)("nav",Object.assign({},x,{"aria-label":o,className:(0,a.i)(s.Z.breadcrumb,n)},j,{children:(0,t.jsx)("ol",{className:s.Z.breadcrumbList,role:"list",children:l.Children.map(i,(e,i)=>(0,l.isValidElement)(e)?(0,l.cloneElement)(e,{showDivider:i>0}):e)})}))};c.displayName="Breadcrumb"},18091:function(e,i,n){n.d(i,{g:()=>d});var r=n(59390),t=n(24246),l=n(91985),s=n(90633),a=n(15508);let d=e=>{var{children:i=null,className:n="",to:d,isActive:c=!1,isDropdown:o=!1,showDivider:u,target:h,component:x="a",render:j}=e,m=(0,r.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let b=c?"page":void 0,v=(0,a.i)(s.Z.breadcrumbLink,c&&s.Z.modifiers.current);return(0,t.jsxs)("li",Object.assign({},m,{className:(0,a.i)(s.Z.breadcrumbItem,n),children:[u&&(0,t.jsx)("span",{className:s.Z.breadcrumbItemDivider,children:(0,t.jsx)(l.ZP,{})}),"button"===x&&(0,t.jsx)("button",{className:v,"aria-current":b,type:"button",children:i}),o&&(0,t.jsx)("span",{className:(0,a.i)(s.Z.breadcrumbDropdown),children:i}),j&&j({className:v,ariaCurrent:b}),d&&!j&&(0,t.jsx)(x,{href:d,target:h,className:v,"aria-current":b,children:i}),!d&&"button"!==x&&!o&&i]}))};d.displayName="BreadcrumbItem"},51527:function(e,i,n){n.d(i,{e:()=>a});var r=n(59390),t=n(24246),l=n(24416),s=n(15508);let a=e=>{var{children:i,className:n,component:a="div",isFilled:d=!0}=e,c=(0,r.__rest)(e,["children","className","component","isFilled"]);return(0,t.jsx)(a,Object.assign({className:(0,s.i)(l.Z.cardBody,!d&&l.Z.modifiers.noFill,n)},c,{children:i}))};a.displayName="CardBody"},87069:function(e,i,n){n.d(i,{l:()=>c});var r=n(59390),t=n(24246),l=n(27378),s=n(15508),a=n(24416),d=n(31757);let c=e=>{var{children:i,className:n,component:c="div"}=e,o=(0,r.__rest)(e,["children","className","component"]);let{cardId:u}=(0,l.useContext)(d.H),h=u?`${u}-title`:"";return(0,t.jsx)("div",{className:(0,s.i)(a.Z.cardTitle),children:(0,t.jsx)(c,Object.assign({className:(0,s.i)(a.Z.cardTitleText,n),id:h||void 0},o,{children:i}))})};c.displayName="CardTitle"},67761:function(e,i,n){n.d(i,{M:()=>a});var r=n(59390),t=n(24246),l=n(38436),s=n(15508);let a=e=>{var{children:i,className:n,icon:a}=e,d=(0,r.__rest)(e,["children","className","icon"]);return(0,t.jsxs)("dt",Object.assign({className:(0,s.i)(l.Z.descriptionListTerm,n)},d,{children:[a?(0,t.jsx)("span",{className:(0,s.i)(l.Z.descriptionListTermIcon),children:a}):null,(0,t.jsx)("span",{className:(0,s.i)(l.Z.descriptionListText),children:i})]}))};a.displayName="DescriptionListTerm"},26235:function(e,i,n){n.d(i,{ZP:()=>r});let r=(0,n(24329).I)({name:"PenIcon",height:512,width:512,svgPath:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z",yOffset:0,xOffset:0,svgClassName:void 0})},37818:function(e,i,n){n.d(i,{u:()=>a});var r=n(24246),t=n(8305),l=n(13754),s=n(39826);let a=e=>e.isFetching?e.isFetchingState||(0,r.jsx)(t.b,{children:(0,r.jsx)(l.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,r.jsx)(s.y,{}):e.children},3586:function(e,i,n){n.d(i,{j:()=>l});var r=n(24246),t=n(27378);let l=e=>{let{children:i}=e,[n,l]=t.useState(!1);return(0,r.jsx)(r.Fragment,{children:i(n,l)})}},24200:function(e,i,n){n.d(i,{G:()=>t});var r=n(24246);let t=e=>{let{vulnerability:i}=e;return(0,r.jsxs)("p",{children:[i.withdrawn&&(0,r.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},74247:function(e,i,n){n.r(i),n.d(i,{default:()=>eb});var r=n(79192),t=n(53195),l=n(24246),s=n(27378),a=n(6501),d=n(45043),c=n(97339),o=n(18091),u=n(11192),h=n(32591),x=n(34747),j=n(46770),m=n(68802),b=n(70400),v=n(32939),y=n(24620),f=n(37961),p=n(69265),g=n(25138),_=n(2075),T=n(27090),N=n(75165),w=n(59086),C=n(78700),E=n(74502),B=n(27031),S=n(6348),F=n(37818),P=n(15726),D=n(73227),Z=n(17598),I=n(65872),K=n(87727),L=n(3498),M=n(31757),k=n(87069),O=n(51527),A=n(30329),q=n(50689),V=n(67761),R=n(81391),G=n(79551),z=n(32489),Y=n(90519),$=n(26235),W=n(73827),H=n(63706),Q=n(15167);let U=e=>{var i,n;let{advisory:r}=e,[t,a]=s.useState(!1),d=()=>{a(!1)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(K.r,{hasGutter:!0,children:[(0,l.jsx)(L.P,{md:4,children:(0,l.jsxs)(M.Z,{isFullHeight:!0,children:[(0,l.jsx)(k.l,{children:"Overview"}),(0,l.jsx)(O.e,{children:(0,l.jsxs)(A.o,{children:[(0,l.jsxs)(q.g,{children:[(0,l.jsx)(V.M,{children:"Title"}),(0,l.jsx)(R.b,{children:r.title})]}),(0,l.jsxs)(q.g,{children:[(0,l.jsx)(V.M,{children:"Type"}),(0,l.jsx)(R.b,{children:r.labels.type})]}),(0,l.jsxs)(q.g,{children:[(0,l.jsx)(V.M,{children:"Size"}),(0,l.jsx)(R.b,{children:(0,I.Z)(r.size)})]}),(0,l.jsxs)(q.g,{children:[(0,l.jsxs)(V.M,{children:["Labels ","",(0,l.jsx)(C.zx,{variant:C.Wu.link,size:"sm",icon:(0,l.jsx)($.ZP,{}),iconPosition:"end",onClick:()=>a(!0),children:"Edit"})]}),(0,l.jsx)(R.b,{children:(0,l.jsx)(M.Z,{isCompact:!0,children:(0,l.jsx)(O.e,{children:r.labels&&(0,l.jsx)(W.C,{defaultIsOpen:!0,value:r.labels})})})})]})]})})]})}),(0,l.jsx)(L.P,{md:4,children:(0,l.jsxs)(M.Z,{isFullHeight:!0,children:[(0,l.jsx)(k.l,{children:"Publisher"}),(0,l.jsx)(O.e,{children:(0,l.jsxs)(A.o,{children:[(0,l.jsxs)(q.g,{children:[(0,l.jsx)(V.M,{children:"Name"}),(0,l.jsx)(R.b,{children:null==(i=r.issuer)?void 0:i.name})]}),(0,l.jsxs)(q.g,{children:[(0,l.jsx)(V.M,{children:"Contact details"}),(0,l.jsx)(R.b,{children:null==(n=r.issuer)?void 0:n.website})]})]})})]})}),(0,l.jsx)(L.P,{md:4,children:(0,l.jsxs)(M.Z,{isFullHeight:!0,children:[(0,l.jsx)(k.l,{children:"Tracking"}),(0,l.jsx)(O.e,{children:(0,l.jsxs)(A.o,{children:[(0,l.jsxs)(q.g,{children:[(0,l.jsx)(V.M,{children:"ID"}),(0,l.jsx)(R.b,{children:r.identifier})]}),(0,l.jsxs)(q.g,{children:[(0,l.jsx)(V.M,{children:"Initial release date"}),(0,l.jsx)(R.b,{children:(0,H.p6)(r.published)})]}),(0,l.jsxs)(q.g,{children:[(0,l.jsx)(V.M,{children:"Current release date"}),(0,l.jsx)(R.b,{children:(0,H.p6)(r.modified)})]})]})})]})})]}),(0,l.jsxs)(G.u,{isOpen:t,variant:"medium",title:"Edit labels",onClose:d,children:[(0,l.jsx)(z.x,{title:"Edit labels"}),(0,l.jsx)(Y.f,{children:(0,l.jsx)(Q.q,{advisory:r,onClose:d})})]})]})};var J=n(70715),X=n(40982),ee=n(89226),ei=n(4835),en=n(14350),er=n(11165),et=n(89330),el=n(31423),es=n(94154),ea=n(9905),ed=n(7615),ec=n(57524),eo=n(3804),eu=n(31336),eh=n(3586),ex=n(24200),ej=n(49988);let em=e=>{let{isFetching:i,fetchError:n,vulnerabilities:s}=e,d=(0,ej.sz)({tableName:"vulnerability-table",idProperty:"identifier",items:s,isLoading:i,columnNames:{identifier:"ID",title:"Title",discovery:"Discovery",release:"Release",score:"Score",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.identifier}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:c,numRenderedColumns:o,propHelpers:{toolbarProps:u,paginationToolbarItemProps:h,paginationProps:x,tableProps:j,getThProps:m,getTrProps:b,getTdProps:v},expansionDerivedState:{isCellExpanded:y}}=d;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(J.o,(0,t._)((0,r._)({},u),{"aria-label":"vulnerability toolbar",children:(0,l.jsx)(X.c,{children:(0,l.jsx)(ee.E,(0,t._)((0,r._)({},h),{children:(0,l.jsx)(eo.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:x})}))})})),(0,l.jsxs)(ei.i,(0,t._)((0,r._)({},j),{"aria-label":"vulnerability table",children:[(0,l.jsx)(en.h,{children:(0,l.jsx)(er.Tr,{children:(0,l.jsxs)(eu.qK,(0,t._)((0,r._)({},d),{children:[(0,l.jsx)(et.Th,(0,r._)({},m({columnKey:"identifier"}))),(0,l.jsx)(et.Th,(0,r._)({},m({columnKey:"title"}))),(0,l.jsx)(et.Th,(0,r._)({},m({columnKey:"discovery"}))),(0,l.jsx)(et.Th,(0,r._)({},m({columnKey:"release"}))),(0,l.jsx)(et.Th,(0,r._)({},m({columnKey:"score"}))),(0,l.jsx)(et.Th,(0,r._)({},m({columnKey:"cwe"})))]}))})}),(0,l.jsx)(eu.hp,{isLoading:i,isError:!!n,isNoData:0===s.length,numRenderedColumns:o,children:null==c?void 0:c.map((e,i)=>{var n;return(0,l.jsx)(el.p,{isExpanded:y(e),children:(0,l.jsx)(er.Tr,(0,t._)((0,r._)({},b({item:e})),{children:(0,l.jsxs)(eu.Cx,(0,t._)((0,r._)({},d),{item:e,rowIndex:i,children:[(0,l.jsx)(es.Td,(0,t._)((0,r._)({width:15,modifier:"breakWord"},v({columnKey:"identifier"})),{children:(0,l.jsx)(a.rU,{to:(0,a.Gn)(B.nB.vulnerabilityDetails,{vulnerabilityId:e.identifier}),children:e.identifier})})),(0,l.jsx)(eh.j,{children:(i,n)=>(0,l.jsx)(es.Td,(0,t._)((0,r._)({width:40,modifier:"truncate",onFocus:()=>n(!0),onBlur:()=>n(!1),tabIndex:0},v({columnKey:"title"})),{children:(0,l.jsx)(ea.cE,{focused:i,wrapModifier:"truncate",children:(0,l.jsx)(ex.G,{vulnerability:e})})}))}),(0,l.jsx)(es.Td,(0,t._)((0,r._)({width:15},v({columnKey:"discovery"})),{children:(0,H.p6)(e.discovered)})),(0,l.jsx)(es.Td,(0,t._)((0,r._)({width:10,modifier:"truncate"},v({columnKey:"release"})),{children:(0,H.p6)(e.released)})),(0,l.jsx)(es.Td,(0,t._)((0,r._)({width:10,modifier:"truncate"},v({columnKey:"score"})),{children:e.severity&&(0,l.jsx)(ec.o,{value:(0,ed.g)(e.severity),score:null!=(n=e.score)?n:null,showLabel:!0,showScore:!0})})),(0,l.jsx)(es.Td,(0,t._)((0,r._)({width:10,modifier:"truncate"},v({columnKey:"cwe"})),{children:e.cwes.join(", ")}))]}))}))},e.identifier)})})]})),(0,l.jsx)(eo.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:x})]})},eb=()=>{var e,i;let n=(0,a.s0)(),{pushNotification:I}=s.useContext(P.c),K=(0,B.ZX)(B.Uo.ADVISORY_ID),{advisory:L,isFetching:M,fetchError:k}=(0,Z.gw)(K),[O,A]=s.useState(!1),q=()=>{A(!O)},{downloadAdvisory:V}=(0,D.i)(),[R,G]=s.useState(!1),{mutate:z,isPending:Y}=(0,Z.y2)(e=>{G(!1),I({title:(0,E.TR)(e),variant:"success"}),n("/advisories")},e=>{I({title:(0,E.BS)(e),variant:"danger"})}),[$,W]=s.useState(0),H=s.createRef(),Q=s.createRef();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.NP,{type:"breadcrumb",children:(0,l.jsxs)(c.a,{children:[(0,l.jsx)(o.g,{children:(0,l.jsx)(a.rU,{to:B.nB.advisories,children:"Advisories"})}),(0,l.jsx)(o.g,{isActive:!0,children:"Advisory details"})]})}),(0,l.jsx)(d.NP,{children:(0,l.jsxs)(u.P,{children:[(0,l.jsx)(h.J,{isFilled:!0,children:(0,l.jsxs)(x.k,{children:[(0,l.jsx)(j.B,{spacer:{default:"spacerSm"},children:(0,l.jsxs)(m.V,{children:[(0,l.jsx)(m.V,{component:"h1",children:null!=(i=null!=(e=null==L?void 0:L.document_id)?e:K)?i:""}),(0,l.jsx)(m.V,{component:"p",children:"Advisory detail information"})]})}),(0,l.jsx)(j.B,{children:(null==L?void 0:L.labels.type)&&(0,l.jsx)(b._,{color:"blue",children:null==L?void 0:L.labels.type})})]})}),(0,l.jsx)(h.J,{children:L&&(0,l.jsx)(v.L,{isOpen:O,onSelect:()=>A(!1),onOpenChange:e=>A(e),popperProps:{position:"right"},toggle:e=>(0,l.jsx)(y.O_,{ref:e,onClick:q,isExpanded:O,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,l.jsxs)(f.s,{children:[(0,l.jsx)(p.h,{onClick:()=>{K&&V(K,(null==L?void 0:L.identifier)?"".concat(null==L?void 0:L.identifier,".json"):"".concat(K,".json"))},children:"Download Advisory"},"advisory"),(0,l.jsx)(g.i,{component:"li"},"separator"),(0,l.jsx)(p.h,{onClick:()=>G(!0),children:"Delete"},"delete")]})})})]})}),(0,l.jsx)(d.NP,{children:(0,l.jsxs)(_.m,{mountOnEnter:!0,activeKey:$,onSelect:(e,i)=>{W(i)},"aria-label":"Tabs that contain the Advisory information",role:"region",children:[(0,l.jsx)(T.O,{eventKey:0,title:(0,l.jsx)(N.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:H}),(0,l.jsx)(T.O,{eventKey:1,title:(0,l.jsx)(N.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:Q})]})}),(0,l.jsxs)(d.NP,{children:[(0,l.jsx)(w.I,{eventKey:0,id:"refTabInfoSection",ref:H,"aria-label":"Information of the Advisory",children:(0,l.jsx)(F.u,{isFetching:M,fetchError:k,children:L&&(0,l.jsx)(U,{advisory:L})})}),(0,l.jsx)(w.I,{eventKey:1,id:"refVulnerabilitiesSection",ref:Q,"aria-label":"Vulnerabilities within the Advisory",hidden:!0,children:(0,l.jsx)(em,{isFetching:M,fetchError:k,vulnerabilities:(null==L?void 0:L.vulnerabilities)||[]})})]}),(0,l.jsx)(S.Q,(0,t._)((0,r._)({},(0,E.gn)(L)),{inProgress:Y,titleIconVariant:"warning",isOpen:R,confirmBtnVariant:C.Wu.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>G(!1),onClose:()=>G(!1),onConfirm:()=>{L&&z(L.uuid)}}))]})}},15167:function(e,i,n){n.d(i,{q:()=>d});var r=n(24246),t=n(27378),l=n(24502),s=n(15726),a=n(17598);let d=e=>{let{advisory:i,onClose:n}=e,{pushNotification:d}=t.useContext(s.c),[c,o]=t.useState(""),[u,h]=t.useState(""),{labels:x}=(0,a.VY)(u);t.useEffect(()=>{let e=setTimeout(()=>{h(c)},400);return()=>clearTimeout(e)},[c]);let{mutate:j,isPending:m}=(0,a.sj)(()=>{d({title:"Labels updated for Advisory ".concat(i.document_id),variant:"success"}),n()},e=>{d({title:"Error while updating labels for Advisory ".concat(i.document_id),variant:"danger"})});return(0,r.jsx)(l.M,{title:"Labels of Advisory: ".concat(i.document_id),value:i.labels,isDisabled:m,onSave:e=>{j({id:i.uuid,labels:e})},onClose:n,onInputChange:o,options:x})}},17598:function(e,i,n){n.d(i,{N7:()=>v,VY:()=>b,gw:()=>y,sj:()=>g,tG:()=>p,y2:()=>f});var r=n(79192),t=n(53195),l=n(70186),s=n(1183),a=n(24038),d=n(68e3),c=n(75503),o=n(50576),u=n(40371),h=n(87017),x=n(49988),j=n(95169);let m="advisories",b=e=>{let{data:i,isLoading:n,error:r,refetch:t}=(0,s.a)({queryKey:[m,"labels",e],queryFn:()=>(0,u.sf)({client:o.L,query:{limit:10,filter_text:e}}),placeholderData:a.Wk});return{labels:(null==i?void 0:i.data)||[],isFetching:n,fetchError:r,refetch:t}},v=function(){var e,i,n;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=(0,x.rm)(a),{q:j}=h,b=(0,l._)(h,["q"]),v=(0,x.Rb)(d),{data:y,isLoading:f,error:p,refetch:g}=(0,s.a)({queryKey:[m,a,v],queryFn:()=>(0,u.A1)({client:o.L,query:(0,t._)((0,r._)({},b),{q:[j,v].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==y||null==(e=y.data)?void 0:e.items)||[],total:null!=(n=null==y||null==(i=y.data)?void 0:i.total)?n:0,params:a},isFetching:f,fetchError:p||null,refetch:g}},y=e=>{let{data:i,isLoading:n,error:r}=(0,s.a)({queryKey:[m,e],queryFn:()=>(0,u.pB)({client:o.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==i?void 0:i.data,isFetching:n,fetchError:r}},f=(e,i)=>{let n=(0,d.NL)();return(0,c.D)({mutationFn:async e=>(await (0,u.Wr)({client:o.L,path:{key:e}})).data,onSuccess:async(i,r)=>{e(i,r),await n.invalidateQueries({queryKey:[m]})},onError:async e=>{i(e),await n.invalidateQueries({queryKey:[m]})}})},p=()=>{let e=(0,d.NL)();return(0,j.V)({parallel:!0,uploadFn:(e,i)=>(0,h.Cu)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},g=(e,i)=>{let n=(0,d.NL)();return(0,c.D)({mutationFn:e=>(0,u.m5)({client:o.L,path:{id:e.id},body:e.labels}),onSuccess:async(i,r)=>{e(),await n.invalidateQueries({queryKey:[m]})},onError:i})}},65872:function(e,i,n){n.d(i,{Z:()=>d});let r=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],t=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],l=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],s=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],a=(e,i,n)=>{let r=e;return"string"==typeof i||Array.isArray(i)?r=e.toLocaleString(i,n):(!0===i||void 0!==n)&&(r=e.toLocaleString(void 0,n)),r};function d(e,i){let n;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let d=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?s:l:i.binary?t:r,c=i.space?" ":"";if(i.signed&&0===e)return` 0${c}${d[0]}`;let o=e<0,u=o?"-":i.signed?"+":"";if(o&&(e=-e),void 0!==i.minimumFractionDigits&&(n={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(n={maximumFractionDigits:i.maximumFractionDigits,...n}),e<1)return u+a(e,i.locale,n)+c+d[0];let h=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),d.length-1);return e/=(i.binary?1024:1e3)**h,n||(e=e.toPrecision(3)),u+a(Number(e),i.locale,n)+c+d[h]}}}]);