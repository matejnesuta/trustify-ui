"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["811"],{566:function(e,t,r){r.r(t),r.d(t,{default:()=>ew});var l,i=r(32909),s=r(42642),n=r(62540),a=r(63696),o=r(68430),c=r(61360),d=r(35048),u=r(56918),p=r(42957),h=r(32490),x=r(98259),y=r(74343),j=r(5530),g=r(69548),f=r(39757),v=r(90280),b=r(65841),m=r(81595),C=r(58780),k=r(34952),S=r(27800),F=r(46173),_=r(99134),A=r(33468),w=r(30111),R=r(31903);let E=e=>(0,n.jsx)(y.N_,{to:e.navLink,style:{textDecoration:"none"},children:(0,n.jsxs)(j.D,{itemId:e.id,description:e.description,children:[e.title," ",(0,n.jsx)(g.J,{color:e.typeColor,children:e.type})]})},e.id),V=e=>{let{onChangeSearch:t}=e,{tableControls:r}=a.useContext(F.L),[l,s]=a.useState(""),[o,c]=a.useState(!1);a.useEffect(()=>{var e;let t=null==(e=r.filterState.filterValues[x._G])?void 0:e[0];s(null!=t?t:"")},[r.filterState]);let[d,u]=(0,S.Q3)(l,500);a.useEffect(()=>{u(l)},[u,l]);let{isFetching:p,list:h}=function(e,t){let r={filters:[{field:x._G,operator:"~",value:e}],page:{pageNumber:1,itemsPerPage:5}},{isFetching:l,result:{data:s}}=(0,_.VH)((0,i._)({},r),[],t),{isFetching:n,result:{data:a}}=(0,A.Lx)((0,i._)({},r),t),{isFetching:o,result:{data:c}}=(0,w.i$)((0,i._)({},r),[],t),{isFetching:d,result:{data:u}}=(0,R.WJ)((0,i._)({},r),t),p=s.map(e=>{var t;return{id:"advisory-".concat(e.uuid),title:e.document_id,description:null==(t=e.title)?void 0:t.substring(0,75),navLink:"/advisories/".concat(e.uuid),type:"Advisory",typeColor:"blue"}}),h=a.map(e=>({id:"package-".concat(e.uuid),title:e.purl,navLink:"/packages/".concat(e.uuid),type:"Package",typeColor:"teal"})),y=c.map(e=>({id:"sbom-".concat(e.id),title:e.name,description:e.suppliers.join(", "),navLink:"/sboms/".concat(e.id),type:"SBOM",typeColor:"purple"})),j=u.map(e=>{var t;return{id:"vulnerability-".concat(e.identifier),title:e.identifier,description:null==(t=e.description)?void 0:t.substring(0,75),navLink:"/vulnerabilities/".concat(e.identifier),type:"Vulnerability",typeColor:"orange"}}),g=e.toLowerCase();return{isFetching:l||n||o||d,list:[...j,...y,...p,...h].sort((e,t)=>{var r,l;return(null==(r=e.title)?void 0:r.includes(g))?-1:(null==(l=t.title)?void 0:l.includes(g))?1:(e.description||"").toLowerCase().indexOf(g)-(t.description||"").toLowerCase().indexOf(g)})}}(d,!o),[y,g]=a.useState(!1),V=a.useRef(null),D=a.useRef(null);a.useEffect(()=>{let e=e=>{var t,r,l;if(y&&V.current&&V.current===e.target)if("Escape"===e.key)g(!1),V.current.focus();else if("ArrowDown"===e.key||"ArrowUp"===e.key){let t=null==(r=D.current)?void 0:r.querySelector("li > button:not(:disabled)");t&&(null==t||t.focus()),e.preventDefault()}else("Tab"===e.key||"Enter"===e.key||"Space"===e.key)&&(g(!1),("Enter"===e.key||"Space"===e.key)&&e.preventDefault());else y&&(null==(t=D.current)?void 0:t.contains(e.target))&&"Tab"===e.key&&(e.preventDefault(),g(!1),null==(l=V.current)||l.focus())},t=e=>{y&&D&&D.current&&!D.current.contains(e.target)&&g(!1)};return window.addEventListener("keydown",e),window.addEventListener("click",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("click",t)}},[y]);let O=(0,n.jsx)(f.W,{ref:D,style:{width:"450px",maxHeight:"450px",overflow:"scroll",overflowX:"hidden",overflowY:"auto"},children:(0,n.jsx)(v.r,{children:(0,n.jsx)(b.c,{children:p?(0,n.jsx)(j.D,{itemId:"loading",children:(0,n.jsx)(m.y,{size:"sm"})}):h.map(E)})})}),P=(0,n.jsx)(C.D,{placeholder:"Search for an SBOM, Package, Advisory, or Vulnerability",value:l,onChange:(e,t)=>{""!==t&&V&&V.current&&V.current.contains(document.activeElement)?g(!0):g(!1),s(t),c(!0)},onClear:()=>{s("")},onSearch:()=>{t(l)},onKeyDown:e=>{if(e.key&&"Enter"!==e.key)return},ref:V,id:"autocomplete-search",style:{width:500}});return(0,n.jsx)(k.N,{trigger:P,triggerRef:V,popper:O,popperRef:D,isVisible:y&&h.length>0||p,enableFlip:!1,appendTo:()=>document.querySelector("#autocomplete-search")})};var D=r(27889),O=r(13701),P=r(62517);function T(e,t){return{Component:e,props:t}}let K=(l=[T(F.c,{}),T(O.a,{}),T(P.y,{}),T(D.r,{})],e=>{let{children:t}=e,r=(0,n.jsx)(n.Fragment,{children:t});return l.reduceRight((e,t)=>{let{Component:r,props:l={}}=t;return(0,n.jsx)(r,(0,s._)((0,i._)({},l),{children:e}),e.key)},r)});var L=r(54518),I=r(48281),B=r(17327),M=r(71603),Y=r(40989),G=r(60423),z=r(40111),H=r(15157),N=r(2057),W=r(70414),$=r(66542),U=r(8210),q=r(88508),J=r(38914),Q=r(57901),X=r(24773),Z=r(72610);r(1480);var ee=r(23909),et=r(41001);let er=e=>{let{category:t,filterValue:r,setFilterValue:l,isDisabled:i=!1}=e,[s,o]=a.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);return a.useEffect(()=>{o(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]),(0,n.jsx)(et.j,{showChips:!0,isDisabled:i,options:s.map(e=>{var t;return{id:e.value,name:null!=(t=e.label)?t:e.value}}),selections:null==r?void 0:r.map(e=>({id:e,name:e})),onChange:e=>{l(e.map(e=>(0,ee.AA)(e.name)))},noResultsMessage:"No search results",placeholderText:t.placeholderText,searchInputAriaLabel:"select-autocomplete-listbox",onSearchChange:t.onInputValueChange})};var el=r(58365);let ei=e=>{let{category:t,filterValue:r,setFilterValue:l}=e,[i,s]=a.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);a.useEffect(()=>{s(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]);let o=Array.isArray(i)?i:Object.values(i).flat();return(0,n.jsx)(n.Fragment,{children:o.map((e,i)=>{let{label:s,value:a}=e;return(0,n.jsx)(el.S,{id:"checkbox-".concat(i,"-").concat(t.categoryKey),isLabelWrapped:!0,label:s,isChecked:null==r?void 0:r.includes(a),onChange:()=>{a&&"No results"!==a&&l((null==r?void 0:r.includes(a))?r.filter(e=>e!==a):r?[...r,a]:[a])}},s)})})};var es=r(75484),en=r(40360),ea=r(38360),eo=r(78109),ec=r(83200);let ed=e=>{let{filterValue:t,setFilterValue:r,isDisabled:l=!1}=e,[i,s]=(0,a.useState)(),[o,c]=(0,a.useState)();return a.useEffect(()=>{if(null==t?void 0:t[0]){let[e,r]=(0,ec.P1)(null==t?void 0:t[0]);s(e.toDate()),c(r.toDate())}else s(void 0),c(void 0)},[t]),(0,n.jsxs)(es.l,{children:[(0,n.jsx)(en.g,{role:"group",isInline:!0,label:"From",children:(0,n.jsx)(ea.l,{value:i?(0,ec.ak)(i):"",dateFormat:ec.ak,dateParse:ec.sy,onChange:(e,t)=>{(0,ec.Fz)(t)&&(s((0,ec.sy)(t)),c(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:l})}),(0,n.jsx)(en.g,{role:"group",isInline:!0,label:"To",children:(0,n.jsx)(ea.l,{value:o?(0,ec.ak)(o):"",onChange:(e,t)=>{if((0,ec.Fz)(t)){let e=(0,ec.sy)(t);c(e);let l=(0,ec.Kg)(i,e);l&&r([l])}},isDisabled:l||!(0,eo.v)(i),dateFormat:ec.ak,dateParse:ec.sy,invalidFormatText:"",rangeStart:i,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})})]})};var eu=r(10562);let ep=e=>{let{category:t,filterValue:r,setFilterValue:l,isDisabled:i=!1}=e;return(0,n.jsx)(n.Fragment,{children:t.selectOptions.map((e,s)=>{let{label:a,value:o}=e,c=(null==r?void 0:r.includes(o))||!1;return(0,n.jsx)(eu.s,{isDisabled:i,id:"radio-".concat(s),name:"radio",isLabelWrapped:!0,label:a,isChecked:c,onChange:()=>{l(t.selectOptions.find(e=>{let{value:t}=e;return t===o})?[o]:null)}},a)})})};var eh=r(58897),ex=r(13135),ey=r(51463);let ej=e=>{let{category:t,filterValue:r,setFilterValue:l,isNumeric:i,isDisabled:s=!1}=e,[o,c]=a.useState((null==r?void 0:r[0])||"");a.useEffect(()=>{c((null==r?void 0:r[0])||"")},[r]);let d=()=>{let e=o.trim();l(e?[e.replace(/\s+/g," ")]:[])},u="".concat(t.categoryKey,"-input");return(0,n.jsxs)(eh.M,{children:[(0,n.jsx)(ex.ks,{name:u,id:"search-input",type:i?"number":"search",onChange:(e,t)=>c(t),"aria-label":"".concat(t.title," filter"),value:o,placeholder:t.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||d()},isDisabled:s}),(0,n.jsx)(X.$n,{icon:(0,n.jsx)(ey.Ay,{}),variant:X.Ak.control,id:"search-button","aria-label":"search button for search input",onClick:d,isDisabled:s})]})},eg=e=>{var{category:t}=e,r=(0,Z._)(e,["category"]);return"select"===t.type?(0,n.jsx)(ep,(0,i._)({category:t},r)):"search"===t.type||"numsearch"===t.type?(0,n.jsx)(ej,(0,i._)({category:t,isNumeric:"numsearch"===t.type},r)):"multiselect"===t.type?(0,n.jsx)(ei,(0,i._)({category:t},r)):"dateRange"===t.type?(0,n.jsx)(ed,(0,i._)({category:t},r)):"autocompleteLabel"===t.type?(0,n.jsx)(er,(0,i._)({category:t},r)):null},ef=e=>{let{filterCategories:t,filterValues:r,setFilterValues:l,isDisabled:a=!1,omitFilterCategoryKeys:o=[]}=e;return(0,n.jsxs)(J.B,{hasGutter:!0,children:[(0,n.jsx)(Q.a,{children:(0,n.jsx)(X.$n,{variant:"link",isInline:!0,onClick:()=>{let e=t.filter(e=>void 0===o.find(t=>t===e.categoryKey)).reduce((e,t)=>(e[t.categoryKey]=void 0,e),{});l((0,i._)({},r,e))},children:"Clear all filters"})}),t.filter(e=>void 0===o.find(t=>t===e.categoryKey)).map(e=>(0,n.jsx)(Q.a,{children:(0,n.jsxs)(J.B,{hasGutter:!0,children:[(0,n.jsx)(Q.a,{children:(0,n.jsx)(p.U,{component:"h4",children:e.title})}),(0,n.jsx)(Q.a,{children:(0,n.jsx)(eg,{category:e,filterValue:r[e.categoryKey],setFilterValue:t=>l((0,s._)((0,i._)({},r),{[e.categoryKey]:t})),isDisabled:a,isSidebar:!0})})]})},e.categoryKey))]})};var ev=r(41484),eb=r(5193),em=r(51888),eC=r(22549),ek=r(74466),eS=r(75725),eF=r(11934),e_=r(13829);let eA=e=>{let{filterPanelProps:t,sbomTable:r,sbomTotalCount:l,packageTable:s,packageTotalCount:o,vulnerabilityTable:c,vulnerabilityTotalCount:d,advisoryTable:u,advisoryTotalCount:p,isFetchingPackages:h,isFetchingSboms:x,isFetchingVulnerabilities:y,isFetchingAdvisories:j}=e,[g,f]=a.useState(0),{sbomFilterPanelProps:v,packageFilterPanelProps:b,vulnerabilityFilterPanelProps:m,advisoryFilterPanelProps:C}=t,k=a.createRef(),S=a.createRef(),F=a.createRef(),_=a.createRef();return(0,n.jsxs)(L.B,{hasGutter:!0,children:[(0,n.jsx)(I.o,{children:(0,n.jsx)(B.Z,{isFullHeight:!0,children:(0,n.jsx)(M.b,{style:{width:241},children:0===g?(0,n.jsx)(ef,(0,i._)({omitFilterCategoryKeys:[""]},v)):1===g?(0,n.jsx)(ef,(0,i._)({omitFilterCategoryKeys:[""]},b)):2===g?(0,n.jsx)(ef,(0,i._)({omitFilterCategoryKeys:[""]},m)):3===g?(0,n.jsx)(ef,(0,i._)({omitFilterCategoryKeys:[""]},C)):null})})}),(0,n.jsx)(I.o,{isFilled:!0,children:(0,n.jsxs)(Y.t,{mountOnEnter:!0,isBox:!0,activeKey:g,onSelect:(e,t)=>{f(t)},"aria-label":"Tabs",role:"region",children:[(0,n.jsxs)(G.o,{eventKey:0,title:(0,n.jsxs)(z.V,{children:["SBOMs","  ",(0,n.jsx)(H.E,{screenReaderText:"Search Result Count",children:x?(0,n.jsx)(N.I,{size:"sm",children:(0,n.jsx)(q.Ay,{})}):l})]}),actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W.o,{"aria-label":"SBOM help popover",ref:k,children:(0,n.jsx)(U.Ay,{})}),(0,n.jsx)($.A,{bodyContent:(0,n.jsx)("div",{children:"A list of ingested Software Bill of Materials (SBOM) documents."}),position:"right",triggerRef:k})]}),children:[(0,n.jsx)(eS.r,{}),null!=r?r:(0,n.jsx)(ek.Y,{})]}),(0,n.jsxs)(G.o,{eventKey:1,title:(0,n.jsxs)(z.V,{children:["Packages","  ",(0,n.jsx)(H.E,{screenReaderText:"Search Result Count",children:h?(0,n.jsx)(N.I,{size:"sm",children:(0,n.jsx)(q.Ay,{})}):o})]}),actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W.o,{"aria-label":"Package help popover",ref:S,children:(0,n.jsx)(U.Ay,{})}),(0,n.jsx)($.A,{bodyContent:(0,n.jsx)("div",{children:"A list of packages along with the count of vulnerabilities."}),position:"right",triggerRef:S})]}),children:[(0,n.jsx)(eC.I,{}),null!=s?s:(0,n.jsx)(em.N,{})]}),(0,n.jsxs)(G.o,{eventKey:2,title:(0,n.jsxs)(z.V,{children:["Vulnerabilities","  ",(0,n.jsx)(H.E,{screenReaderText:"Search Result Count",children:y?(0,n.jsx)(N.I,{size:"sm",children:(0,n.jsx)(q.Ay,{})}):d})]}),actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W.o,{"aria-label":"Vulnerability help popover",ref:F,children:(0,n.jsx)(U.Ay,{})}),(0,n.jsx)($.A,{bodyContent:(0,n.jsx)("div",{children:"A list of publicly known Common Vulnerabilities and Exposures (CVE)."}),position:"right",triggerRef:F})]}),children:[(0,n.jsx)(e_.y,{}),null!=c?c:(0,n.jsx)(eF.f,{})]}),(0,n.jsxs)(G.o,{eventKey:3,title:(0,n.jsxs)(z.V,{children:["Advisories","  ",(0,n.jsx)(H.E,{screenReaderText:"Advisory Result Count",children:j?(0,n.jsx)(N.I,{size:"sm",children:(0,n.jsx)(q.Ay,{})}):p})]}),actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W.o,{"aria-label":"Advisory help popover",ref:_,children:(0,n.jsx)(U.Ay,{})}),(0,n.jsx)($.A,{bodyContent:(0,n.jsx)("div",{children:"A list of available advisories."}),position:"right",triggerRef:_})]}),children:[(0,n.jsx)(eb.F,{}),null!=u?u:(0,n.jsx)(ev.q,{})]})]})})]})},ew=e=>{let{searchBodyOverride:t}=e;return(0,n.jsx)(K,{children:(0,n.jsx)(eR,{searchBodyOverride:t})})},eR=e=>{let{searchBodyOverride:t}=e,{tableControls:r}=a.useContext(F.L),{tableControls:l}=a.useContext(O.Y),{tableControls:y}=a.useContext(P.u),{tableControls:j}=a.useContext(D.R),{isFetching:g,totalItemCount:f,tableControls:{propHelpers:{filterPanelProps:v}}}=a.useContext(F.L),{isFetching:b,totalItemCount:m,tableControls:{propHelpers:{filterPanelProps:C}}}=a.useContext(O.Y),{isFetching:k,totalItemCount:S,tableControls:{propHelpers:{filterPanelProps:_}}}=a.useContext(P.u),{isFetching:A,totalItemCount:w,tableControls:{propHelpers:{filterPanelProps:R}}}=a.useContext(D.R),E=(0,n.jsx)(eA,{filterPanelProps:{advisoryFilterPanelProps:R,packageFilterPanelProps:C,sbomFilterPanelProps:v,vulnerabilityFilterPanelProps:_},packageTotalCount:m,sbomTotalCount:f,vulnerabilityTotalCount:S,advisoryTotalCount:w,isFetchingPackages:b,isFetchingSboms:g,isFetchingVulnerabilities:k,isFetchingAdvisories:A});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.d8,{hasBodyWrapper:!1,children:(0,n.jsx)(c.M,{isStatic:!0,children:(0,n.jsxs)(d.P,{children:[(0,n.jsx)(u.$,{align:{default:"alignStart"},children:(0,n.jsx)(p.U,{children:(0,n.jsx)(p.U,{component:"h1",children:"Search Results"})})}),(0,n.jsx)(u.$,{variant:"action-group-plain",align:{default:"alignEnd"},children:(0,n.jsx)(u.$,{visibility:{default:"visible"},children:(0,n.jsx)(h.T,{children:(0,n.jsx)(V,{onChangeSearch:e=>{void 0!==e&&(r.filterState.setFilterValues((0,s._)((0,i._)({},r.filterState.filterValues),{[x._G]:[e]})),l.filterState.setFilterValues((0,s._)((0,i._)({},l.filterState.filterValues),{[x._G]:[e]})),y.filterState.setFilterValues((0,s._)((0,i._)({},y.filterState.filterValues),{[x._G]:[e]})),j.filterState.setFilterValues((0,s._)((0,i._)({},j.filterState.filterValues),{[x._G]:[e]})))}})})})})]})})}),(0,n.jsx)(o.d8,{hasBodyWrapper:!1,children:t||E})]})}}}]);