"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["556"],{89705:function(e,i,n){n.d(i,{T:()=>c});var l=n(62540),r=n(24773),t=n(38927),s=n(80057),a=n(13021),d=n(97346);let c=e=>{let{isOpen:i,title:n,titleIconVariant:c,message:o,confirmBtnLabel:h,cancelBtnLabel:u,inProgress:j,confirmBtnVariant:x,onClose:b,onConfirm:v,onCancel:m}=e,y=(0,l.jsx)(r.$n,{id:"confirm-dialog-button","aria-label":"confirm",variant:x,isDisabled:j,onClick:v,children:h},"confirm"),p=m?(0,l.jsx)(r.$n,{id:"confirm-cancel-button","aria-label":"cancel",variant:r.Ak.link,isDisabled:j,onClick:m,children:u},"cancel"):void 0;return(0,l.jsxs)(t.a,{id:"confirm-dialog",variant:"small",isOpen:i,onClose:b,"aria-label":"Confirm dialog",children:[(0,l.jsx)(s.r,{title:n,titleIconVariant:c}),(0,l.jsx)(a.c,{children:o}),(0,l.jsx)(d.j,{children:m?(0,l.jsxs)(l.Fragment,{children:[y,p]}):y})]})}},91242:function(e,i,n){n.d(i,{e:()=>p});var l=n(62540),r=n(63696),t=n(38914),s=n(57901),a=n(40360),d=n(42957),c=n(17327),o=n(23546),h=n(69548),u=n(75484),j=n(36284),x=n(24773),b=n(23909),v=n(71284),m=n(41001);let y=e=>{let i=(0,v.m4)(e);return{id:i,name:i}},p=e=>{let{title:i,value:n,isDisabled:p,onSave:f,onClose:g,options:_,onInputChange:C}=e,[S,A]=r.useState(Object.entries(n).map(e=>{let[i,n]=e;return y({key:i,value:n})}));return(0,l.jsxs)(t.B,{hasGutter:!0,children:[(0,l.jsx)(s.a,{children:"Labels help you organize and select resources. Adding labels below will let you query for objects that have similar, overlapping or dissimilar labels."}),(0,l.jsx)(s.a,{children:(0,l.jsx)(a.g,{label:(0,l.jsx)(d.U,{component:"h4",children:i}),children:(0,l.jsx)(c.Z,{children:(0,l.jsx)(o.o,{style:{padding:10,minHeight:10},defaultIsOpen:!0,numLabels:10,children:S.sort((e,i)=>(0,b.AA)(e.name).localeCompare((0,b.AA)(i.name))).map((e,i)=>(0,l.jsx)(h.J,{color:"blue",onClose:()=>{let e=[...S];e.splice(i,1),A(e)},children:(0,b.AA)(e.labelName||e.name)},e.id))})})})}),(0,l.jsx)(s.a,{children:(0,l.jsxs)(u.l,{onSubmit:e=>e.preventDefault(),children:[(0,l.jsx)(m.j,{selections:S,options:_.map(e=>{let{key:i,value:n}=e;return y({key:i,value:n})}),onChange:A,placeholderText:"Add label",searchInputAriaLabel:"labels-select-toggle",onSearchChange:C,onCreateNewOption:e=>({id:e,name:e}),validateNewOption:e=>!!e&&e.trim().length>0&&/^(?!.*\\)(?!\s*\\)(?!\s*=)[^=\\\s][^=\\]*\s*=?\s*[^=\\]+$/.test(e),filterBeforeOnChange:(e,i)=>{let n=(0,v.Cb)((0,b.AA)(i.name));return e.filter(e=>(0,v.Cb)((0,b.AA)(e.name)).key!==n.key)}}),(0,l.jsxs)(j.K,{children:[(0,l.jsx)(x.$n,{type:"button",id:"submit","aria-label":"submit",variant:x.Ak.primary,isDisabled:p,onClick:()=>{f(S.map(e=>(0,v.Cb)((0,b.AA)(e.name))).reduce((e,i)=>{let{key:n,value:l}=i;return e[n]=null!=l?l:"",e},{}))},children:"Save"}),(0,l.jsx)(x.$n,{type:"button",id:"cancel","aria-label":"cancel",variant:x.Ak.link,isDisabled:p,onClick:g,children:"Cancel"})]})]})})]})}},12852:function(e,i,n){n.d(i,{g:()=>d});var l=n(62540),r=n(23546),t=n(69548),s=n(41628),a=n(71284);let d=e=>{let{value:i,defaultIsOpen:n,onClick:d}=e;return(0,l.jsx)(r.o,{defaultIsOpen:n,numLabels:5,children:Object.entries(i).sort((e,i)=>{let[n]=e,[l]=i;return l.localeCompare(n)}).map(e=>{let[i,n]=e;return(0,l.jsx)(t.J,{color:"blue",onClick:d?()=>d({key:i,value:n}):void 0,children:(0,l.jsx)(s.P,{content:(0,a.m4)({key:i,value:n})})},i)})})}},24296:function(e,i,n){n.d(i,{a:()=>a});var l=n(62540),r=n(59394),t=n(81595),s=n(40554);let a=e=>e.isFetching?e.isFetchingState||(0,l.jsx)(r.a,{children:(0,l.jsx)(t.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,l.jsx)(s.q,{}):e.children},20311:function(e,i,n){n.d(i,{R:()=>t});var l=n(62540),r=n(63696);let t=e=>{let{children:i}=e,[n,t]=r.useState(!1);return(0,l.jsx)(l.Fragment,{children:i(n,t)})}},64377:function(e,i,n){n.d(i,{j:()=>r});var l=n(62540);let r=e=>{let{vulnerability:i}=e;return(0,l.jsxs)("p",{children:[i.withdrawn&&(0,l.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},99528:function(e,i,n){n.d(i,{m:()=>d});var l=n(22249),r=n(81895),t=n(96002),s=n(86141),a=n(23909);let d=()=>({downloadAdvisory:(e,i)=>{(0,s.Mu)({client:t.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(n=>{(0,l.saveAs)(new Blob([n.data]),i||"".concat(e,".json"))})},downloadSBOM:(e,i)=>{(0,s.K0)({client:t.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(n=>{(0,l.saveAs)(new Blob([n.data]),i||"".concat(e,".json"))})},downloadSBOMLicenses:e=>{(0,r.Z3)(e).then(i=>{var n,r;let t=null,s=null==(r=i.headers)||null==(n=r["content-disposition"])?void 0:n.toString();s&&(t=(0,a.uz)(s)),(0,l.saveAs)(new Blob([i.data]),t||"".concat(e,".tar.gz"))})}})},11179:function(e,i,n){n.r(i),n.d(i,{default:()=>ev});var l=n(32909),r=n(42642),t=n(62540),s=n(63696),a=n(74343),d=n(68430),c=n(98261),o=n(75530),h=n(54518),u=n(48281),j=n(28338),x=n(70045),b=n(42957),v=n(69548),m=n(90717),y=n(96526),p=n(52993),f=n(84818),g=n(7261),_=n(40989),C=n(60423),S=n(40111),A=n(93472),w=n(24773),E=n(98259),T=n(52362),k=n(89705),K=n(24296),F=n(4392),I=n(99528),q=n(99134),O=n(51380),D=n(76072),B=n(97299),P=n(17327),L=n(64361),J=n(71603),Z=n(1020),W=n(24974),N=n(21639),V=n(3939),X=n(38927),R=n(80057),Y=n(13021),z=n(10410),H=n(12852),M=n(23909),Q=n(40665);let U=e=>{var i,n;let{advisory:l}=e,[r,a]=s.useState(!1),d=()=>{a(!1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(D.x,{hasGutter:!0,children:[(0,t.jsx)(B.E,{md:4,children:(0,t.jsxs)(P.Z,{isFullHeight:!0,children:[(0,t.jsx)(L.Z,{children:"Overview"}),(0,t.jsx)(J.b,{children:(0,t.jsxs)(Z.B,{children:[(0,t.jsxs)(W.W,{children:[(0,t.jsx)(N.X,{children:"Title"}),(0,t.jsx)(V.d,{children:l.title})]}),(0,t.jsxs)(W.W,{children:[(0,t.jsx)(N.X,{children:"Type"}),(0,t.jsx)(V.d,{children:l.labels.type})]}),(0,t.jsxs)(W.W,{children:[(0,t.jsx)(N.X,{children:"Size"}),(0,t.jsx)(V.d,{children:(0,O.A)(l.size)})]}),(0,t.jsxs)(W.W,{children:[(0,t.jsxs)(N.X,{children:["Labels ","",(0,t.jsx)(w.$n,{variant:w.Ak.link,size:"sm",icon:(0,t.jsx)(z.Ay,{}),iconPosition:"end",onClick:()=>a(!0),children:"Edit"})]}),(0,t.jsx)(V.d,{children:(0,t.jsx)(P.Z,{isCompact:!0,children:(0,t.jsx)(J.b,{children:l.labels&&(0,t.jsx)(H.g,{defaultIsOpen:!0,value:l.labels})})})})]})]})})]})}),(0,t.jsx)(B.E,{md:4,children:(0,t.jsxs)(P.Z,{isFullHeight:!0,children:[(0,t.jsx)(L.Z,{children:"Publisher"}),(0,t.jsx)(J.b,{children:(0,t.jsxs)(Z.B,{children:[(0,t.jsxs)(W.W,{children:[(0,t.jsx)(N.X,{children:"Name"}),(0,t.jsx)(V.d,{children:null==(i=l.issuer)?void 0:i.name})]}),(0,t.jsxs)(W.W,{children:[(0,t.jsx)(N.X,{children:"Contact details"}),(0,t.jsx)(V.d,{children:null==(n=l.issuer)?void 0:n.website})]})]})})]})}),(0,t.jsx)(B.E,{md:4,children:(0,t.jsxs)(P.Z,{isFullHeight:!0,children:[(0,t.jsx)(L.Z,{children:"Tracking"}),(0,t.jsx)(J.b,{children:(0,t.jsxs)(Z.B,{children:[(0,t.jsxs)(W.W,{children:[(0,t.jsx)(N.X,{children:"ID"}),(0,t.jsx)(V.d,{children:l.identifier})]}),(0,t.jsxs)(W.W,{children:[(0,t.jsx)(N.X,{children:"Initial release date"}),(0,t.jsx)(V.d,{children:(0,M.Yq)(l.published)})]}),(0,t.jsxs)(W.W,{children:[(0,t.jsx)(N.X,{children:"Current release date"}),(0,t.jsx)(V.d,{children:(0,M.Yq)(l.modified)})]})]})})]})})]}),(0,t.jsxs)(X.a,{isOpen:r,variant:"medium",title:"Edit labels",onClose:d,children:[(0,t.jsx)(R.r,{title:"Edit labels"}),(0,t.jsx)(Y.c,{children:(0,t.jsx)(Q.t,{advisory:l,onClose:d})})]})]})};var $=n(61360),G=n(35048),ee=n(32490),ei=n(26917),en=n(16646),el=n(21758),er=n(40384),et=n(28516),es=n(78517),ea=n(59771),ed=n(27875),ec=n(45969),eo=n(93826),eh=n(30448),eu=n(20311),ej=n(64377),ex=n(73470);let eb=e=>{let{isFetching:i,fetchError:n,vulnerabilities:s}=e,d=(0,ex.vY)({tableName:"vulnerability-table",idProperty:"identifier",items:s,isLoading:i,columnNames:{identifier:"ID",title:"Title",discovery:"Discovery",release:"Release",score:"Score",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.identifier}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:c,numRenderedColumns:o,propHelpers:{toolbarProps:h,paginationToolbarItemProps:u,paginationProps:j,tableProps:x,getThProps:b,getTrProps:v,getTdProps:m},expansionDerivedState:{isCellExpanded:y}}=d;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($.M,(0,r._)((0,l._)({},h),{"aria-label":"vulnerability toolbar",children:(0,t.jsx)(G.P,{children:(0,t.jsx)(ee.T,(0,r._)((0,l._)({},u),{children:(0,t.jsx)(eo.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:j})}))})})),(0,t.jsxs)(ei.X,(0,r._)((0,l._)({},x),{"aria-label":"vulnerability table",children:[(0,t.jsx)(en.d,{children:(0,t.jsx)(el.Tr,{children:(0,t.jsxs)(eh.Ze,(0,r._)((0,l._)({},d),{children:[(0,t.jsx)(er.Th,(0,l._)({},b({columnKey:"identifier"}))),(0,t.jsx)(er.Th,(0,l._)({},b({columnKey:"title"}))),(0,t.jsx)(er.Th,(0,l._)({},b({columnKey:"discovery"}))),(0,t.jsx)(er.Th,(0,l._)({},b({columnKey:"release"}))),(0,t.jsx)(er.Th,(0,l._)({},b({columnKey:"score"}))),(0,t.jsx)(er.Th,(0,l._)({},b({columnKey:"cwe"})))]}))})}),(0,t.jsx)(eh.nJ,{isLoading:i,isError:!!n,isNoData:0===s.length,numRenderedColumns:o,children:null==c?void 0:c.map((e,i)=>{var n;return(0,t.jsx)(et.N,{isExpanded:y(e),children:(0,t.jsx)(el.Tr,(0,r._)((0,l._)({},v({item:e})),{children:(0,t.jsxs)(eh.Oi,(0,r._)((0,l._)({},d),{item:e,rowIndex:i,children:[(0,t.jsx)(es.Td,(0,r._)((0,l._)({width:15,modifier:"breakWord"},m({columnKey:"identifier"})),{children:(0,t.jsx)(a.N_,{to:(0,a.tW)(T.Jh.vulnerabilityDetails,{vulnerabilityId:e.identifier}),children:e.identifier})})),(0,t.jsx)(eu.R,{children:(i,n)=>(0,t.jsx)(es.Td,(0,r._)((0,l._)({width:40,modifier:"truncate",onFocus:()=>n(!0),onBlur:()=>n(!1),tabIndex:0},m({columnKey:"title"})),{children:(0,t.jsx)(ea.mA,{focused:i,wrapModifier:"truncate",children:(0,t.jsx)(ej.j,{vulnerability:e})})}))}),(0,t.jsx)(es.Td,(0,r._)((0,l._)({width:15},m({columnKey:"discovery"})),{children:(0,M.Yq)(e.discovered)})),(0,t.jsx)(es.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},m({columnKey:"release"})),{children:(0,M.Yq)(e.released)})),(0,t.jsx)(es.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},m({columnKey:"score"})),{children:e.severity&&(0,t.jsx)(ec.h,{value:(0,ed.U)(e.severity),score:null!=(n=e.score)?n:null,showLabel:!0,showScore:!0})})),(0,t.jsx)(es.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},m({columnKey:"cwe"})),{children:e.cwes.join(", ")}))]}))}))},e.identifier)})})]})),(0,t.jsx)(eo.n,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:j})]})},ev=()=>{var e,i;let n=(0,a.Zp)(),{pushNotification:O}=s.useContext(F.K),D=(0,T.Lu)("advisoryId"),{advisory:B,isFetching:P,fetchError:L}=(0,q.vy)(D),[J,Z]=s.useState(!1),W=()=>{Z(!J)},{downloadAdvisory:N}=(0,I.m)(),[V,X]=s.useState(!1),{mutate:R,isPending:Y}=(0,q.ni)(e=>{X(!1),O({title:(0,E.PN)(e),variant:"success"}),n("/advisories")},e=>{O({title:(0,E.EU)(e),variant:"danger"})}),[z,H]=s.useState(0),M=s.createRef(),Q=s.createRef();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.d8,{type:"breadcrumb",children:(0,t.jsxs)(c.Q,{children:[(0,t.jsx)(o.J,{children:(0,t.jsx)(a.N_,{to:T.Jh.advisories,children:"Advisories"})}),(0,t.jsx)(o.J,{isActive:!0,children:"Advisory details"})]})}),(0,t.jsx)(d.d8,{children:(0,t.jsxs)(h.B,{children:[(0,t.jsx)(u.o,{isFilled:!0,children:(0,t.jsxs)(j.s,{children:[(0,t.jsx)(x.Z,{spacer:{default:"spacerSm"},children:(0,t.jsxs)(b.U,{children:[(0,t.jsx)(b.U,{component:"h1",children:null!=(i=null!=(e=null==B?void 0:B.document_id)?e:D)?i:""}),(0,t.jsx)(b.U,{component:"p",children:"Advisory detail information"})]})}),(0,t.jsx)(x.Z,{children:(null==B?void 0:B.labels.type)&&(0,t.jsx)(v.J,{color:"blue",children:null==B?void 0:B.labels.type})})]})}),(0,t.jsx)(u.o,{children:B&&(0,t.jsx)(m.m,{isOpen:J,onSelect:()=>Z(!1),onOpenChange:e=>Z(e),popperProps:{position:"right"},toggle:e=>(0,t.jsx)(y.S3,{ref:e,onClick:W,isExpanded:J,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,t.jsxs)(p.Q,{children:[(0,t.jsx)(f.t,{onClick:()=>{D&&N(D,(null==B?void 0:B.identifier)?"".concat(null==B?void 0:B.identifier,".json"):"".concat(D,".json"))},children:"Download Advisory"},"advisory"),(0,t.jsx)(g.c,{component:"li"},"separator"),(0,t.jsx)(f.t,{onClick:()=>X(!0),children:"Delete"},"delete")]})})})]})}),(0,t.jsx)(d.d8,{children:(0,t.jsxs)(_.t,{mountOnEnter:!0,activeKey:z,onSelect:(e,i)=>{H(i)},"aria-label":"Tabs that contain the Advisory information",role:"region",children:[(0,t.jsx)(C.o,{eventKey:0,title:(0,t.jsx)(S.V,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:M}),(0,t.jsx)(C.o,{eventKey:1,title:(0,t.jsx)(S.V,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:Q})]})}),(0,t.jsxs)(d.d8,{children:[(0,t.jsx)(A.J,{eventKey:0,id:"refTabInfoSection",ref:M,"aria-label":"Information of the Advisory",children:(0,t.jsx)(K.a,{isFetching:P,fetchError:L,children:B&&(0,t.jsx)(U,{advisory:B})})}),(0,t.jsx)(A.J,{eventKey:1,id:"refVulnerabilitiesSection",ref:Q,"aria-label":"Vulnerabilities within the Advisory",hidden:!0,children:(0,t.jsx)(eb,{isFetching:P,fetchError:L,vulnerabilities:(null==B?void 0:B.vulnerabilities)||[]})})]}),(0,t.jsx)(k.T,(0,r._)((0,l._)({},(0,E.p6)(B)),{inProgress:Y,titleIconVariant:"warning",isOpen:V,confirmBtnVariant:w.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>X(!1),onClose:()=>X(!1),onConfirm:()=>{B&&R(B.uuid)}}))]})}},40665:function(e,i,n){n.d(i,{t:()=>d});var l=n(62540),r=n(63696),t=n(91242),s=n(4392),a=n(99134);let d=e=>{let{advisory:i,onClose:n}=e,{pushNotification:d}=r.useContext(s.K),[c,o]=r.useState(""),[h,u]=r.useState(""),{labels:j}=(0,a.eq)(h);r.useEffect(()=>{let e=setTimeout(()=>{u(c)},400);return()=>clearTimeout(e)},[c]);let{mutate:x,isPending:b}=(0,a.uJ)(()=>{d({title:"Labels updated for Advisory ".concat(i.document_id),variant:"success"}),n()},e=>{d({title:"Error while updating labels for Advisory ".concat(i.document_id),variant:"danger"})});return(0,l.jsx)(t.e,{title:"Labels of Advisory: ".concat(i.document_id),value:i.labels,isDisabled:b,onSave:e=>{x({id:i.uuid,labels:e})},onClose:n,onInputChange:o,options:j})}},99134:function(e,i,n){n.d(i,{VH:()=>m,Yu:()=>f,eq:()=>v,ni:()=>p,uJ:()=>g,vy:()=>y});var l=n(32909),r=n(42642),t=n(72610),s=n(77184),a=n(59722),d=n(62603),c=n(90130),o=n(96002),h=n(86141),u=n(81895),j=n(73470),x=n(93531);let b="advisories",v=e=>{let{data:i,isLoading:n,error:l,refetch:r}=(0,s.I)({queryKey:[b,"labels",e],queryFn:()=>(0,h.J)({client:o.S,query:{limit:10,filter_text:e}}),placeholderData:a.rX});return{labels:(null==i?void 0:i.data)||[],isFetching:n,fetchError:l,refetch:r}},m=function(){var e,i,n;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,j.kd)(a),{q:x}=u,v=(0,t._)(u,["q"]),m=(0,j.Er)(d),{data:y,isLoading:p,error:f,refetch:g}=(0,s.I)({queryKey:[b,a,m],queryFn:()=>(0,h.YM)({client:o.S,query:(0,r._)((0,l._)({},v),{q:[x,m].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==y||null==(e=y.data)?void 0:e.items)||[],total:null!=(n=null==y||null==(i=y.data)?void 0:i.total)?n:0,params:a},isFetching:p,fetchError:f||null,refetch:g}},y=e=>{let{data:i,isLoading:n,error:l}=(0,s.I)({queryKey:[b,e],queryFn:()=>(0,h.ai)({client:o.S,path:{key:e}}),enabled:void 0!==e});return{advisory:null==i?void 0:i.data,isFetching:n,fetchError:l}},p=(e,i)=>{let n=(0,d.jE)();return(0,c.n)({mutationFn:async e=>(await (0,h.vl)({client:o.S,path:{key:e}})).data,onSuccess:async(i,l)=>{e(i,l),await n.invalidateQueries({queryKey:[b]})},onError:async e=>{i(e),await n.invalidateQueries({queryKey:[b]})}})},f=()=>{let e=(0,d.jE)();return(0,x.v)({parallel:!0,uploadFn:(e,i)=>(0,u.hP)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[b]})}})},g=(e,i)=>{let n=(0,d.jE)();return(0,c.n)({mutationFn:e=>(0,h._e)({client:o.S,path:{id:e.id},body:e.labels}),onSuccess:async(i,l)=>{e(),await n.invalidateQueries({queryKey:[b]})},onError:i})}}}]);