"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["256"],{89705:function(e,t,a){a.d(t,{T:()=>c});var l=a(62540),r=a(24773),n=a(38927),i=a(80057),s=a(13021),o=a(97346);let c=e=>{let{isOpen:t,title:a,titleIconVariant:c,message:u,confirmBtnLabel:d,cancelBtnLabel:h,inProgress:v,confirmBtnVariant:y,onClose:p,onConfirm:b,onCancel:f}=e,m=(0,l.jsx)(r.$n,{id:"confirm-dialog-button","aria-label":"confirm",variant:y,isDisabled:v,onClick:b,children:d},"confirm"),g=f?(0,l.jsx)(r.$n,{id:"confirm-cancel-button","aria-label":"cancel",variant:r.Ak.link,isDisabled:v,onClick:f,children:h},"cancel"):void 0;return(0,l.jsxs)(n.a,{id:"confirm-dialog",variant:"small",isOpen:t,onClose:p,"aria-label":"Confirm dialog",children:[(0,l.jsx)(i.r,{title:a,titleIconVariant:c}),(0,l.jsx)(s.c,{children:u}),(0,l.jsx)(o.j,{children:f?(0,l.jsxs)(l.Fragment,{children:[m,g]}):m})]})}},91242:function(e,t,a){a.d(t,{e:()=>g});var l=a(62540),r=a(63696),n=a(38914),i=a(57901),s=a(40360),o=a(42957),c=a(17327),u=a(23546),d=a(69548),h=a(75484),v=a(36284),y=a(24773),p=a(23909),b=a(71284),f=a(41001);let m=e=>{let t=(0,b.m4)(e);return{id:t,name:t}},g=e=>{let{title:t,value:a,isDisabled:g,onSave:j,onClose:x,options:S,onInputChange:k}=e,[_,w]=r.useState(Object.entries(a).map(e=>{let[t,a]=e;return m({key:t,value:a})}));return(0,l.jsxs)(n.B,{hasGutter:!0,children:[(0,l.jsx)(i.a,{children:"Labels help you organize and select resources. Adding labels below will let you query for objects that have similar, overlapping or dissimilar labels."}),(0,l.jsx)(i.a,{children:(0,l.jsx)(s.g,{label:(0,l.jsx)(o.U,{component:"h4",children:t}),children:(0,l.jsx)(c.Z,{children:(0,l.jsx)(u.o,{style:{padding:10,minHeight:10},defaultIsOpen:!0,numLabels:10,children:_.sort((e,t)=>(0,p.AA)(e.name).localeCompare((0,p.AA)(t.name))).map((e,t)=>(0,l.jsx)(d.J,{color:"blue",onClose:()=>{let e=[..._];e.splice(t,1),w(e)},children:(0,p.AA)(e.labelName||e.name)},e.id))})})})}),(0,l.jsx)(i.a,{children:(0,l.jsxs)(h.l,{onSubmit:e=>e.preventDefault(),children:[(0,l.jsx)(f.j,{selections:_,options:S.map(e=>{let{key:t,value:a}=e;return m({key:t,value:a})}),onChange:w,placeholderText:"Add label",searchInputAriaLabel:"labels-select-toggle",onSearchChange:k,onCreateNewOption:e=>({id:e,name:e}),validateNewOption:e=>!!e&&e.trim().length>0&&/^(?!.*\\)(?!\s*\\)(?!\s*=)[^=\\\s][^=\\]*\s*=?\s*[^=\\]+$/.test(e),filterBeforeOnChange:(e,t)=>{let a=(0,b.Cb)((0,p.AA)(t.name));return e.filter(e=>(0,b.Cb)((0,p.AA)(e.name)).key!==a.key)}}),(0,l.jsxs)(v.K,{children:[(0,l.jsx)(y.$n,{type:"button",id:"submit","aria-label":"submit",variant:y.Ak.primary,isDisabled:g,onClick:()=>{j(_.map(e=>(0,b.Cb)((0,p.AA)(e.name))).reduce((e,t)=>{let{key:a,value:l}=t;return e[a]=null!=l?l:"",e},{}))},children:"Save"}),(0,l.jsx)(y.$n,{type:"button",id:"cancel","aria-label":"cancel",variant:y.Ak.link,isDisabled:g,onClick:x,children:"Cancel"})]})]})})]})}},12852:function(e,t,a){a.d(t,{g:()=>o});var l=a(62540),r=a(23546),n=a(69548),i=a(41628),s=a(71284);let o=e=>{let{value:t,defaultIsOpen:a,onClick:o}=e;return(0,l.jsx)(r.o,{defaultIsOpen:a,numLabels:5,children:Object.entries(t).sort((e,t)=>{let[a]=e,[l]=t;return l.localeCompare(a)}).map(e=>{let[t,a]=e;return(0,l.jsx)(n.J,{color:"blue",onClick:o?()=>o({key:t,value:a}):void 0,children:(0,l.jsx)(i.P,{content:(0,s.m4)({key:t,value:a})})},t)})})}},24296:function(e,t,a){a.d(t,{a:()=>s});var l=a(62540),r=a(59394),n=a(81595),i=a(40554);let s=e=>e.isFetching?e.isFetchingState||(0,l.jsx)(r.a,{children:(0,l.jsx)(n.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,l.jsx)(i.q,{}):e.children},92107:function(e,t,a){a.d(t,{D:()=>n});var l=a(62540),r=a(69548);let n=e=>{let{error:t}=e;return(0,l.jsxs)(r.J,{color:"red",children:[t.status," Error"]})}},15461:function(e,t,a){a.d(t,{n:()=>u});var l=a(62540),r=a(28338),n=a(70045),i=a(7261),s=a(86099),o=a(71284),c=a(45969);let u=e=>{let{severities:t}=e,a=Object.values(t).reduce((e,t)=>e+t,0);return(0,l.jsxs)(r.s,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,l.jsx)(n.Z,{"aria-label":"total",style:{minWidth:15,textAlign:s.pG},children:a}),(0,l.jsx)(i.c,{orientation:{default:"vertical"}}),(0,l.jsx)(n.Z,{children:(0,l.jsx)(r.s,{children:Object.entries(t).filter(e=>{let[t,a]=e;return a>0}).sort((0,o.Sx)(e=>{let[t,a]=e;return t})).reverse().map(e=>{let[t,a]=e;return(0,l.jsx)(n.Z,{spacer:{default:"spacerXs"},children:(0,l.jsxs)(r.s,{"aria-label":t,spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,l.jsx)(n.Z,{children:(0,l.jsx)(c.h,{value:t,score:null})}),(0,l.jsx)(n.Z,{children:a})]})},t)})})})]})}},99528:function(e,t,a){a.d(t,{m:()=>o});var l=a(22249),r=a(81895),n=a(96002),i=a(86141),s=a(23909);let o=()=>({downloadAdvisory:(e,t)=>{(0,i.Mu)({client:n.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(a=>{(0,l.saveAs)(new Blob([a.data]),t||"".concat(e,".json"))})},downloadSBOM:(e,t)=>{(0,i.K0)({client:n.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(a=>{(0,l.saveAs)(new Blob([a.data]),t||"".concat(e,".json"))})},downloadSBOMLicenses:e=>{(0,r.Z3)(e).then(t=>{var a,r;let n=null,i=null==(r=t.headers)||null==(a=r["content-disposition"])?void 0:a.toString();i&&(n=(0,s.uz)(i)),(0,l.saveAs)(new Blob([t.data]),n||"".concat(e,".tar.gz"))})}})},3652:function(e,t,a){a.d(t,{RQ:()=>u,UI:()=>h,nm:()=>v});var l=a(32909),r=a(42642),n=a(63696),i=a(27875),s=a(30111);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},u={vulnerabilityStatus:{affected:(0,l._)({},c),fixed:(0,l._)({},c),not_affected:(0,l._)({},c),known_not_affected:(0,l._)({},c),under_investigation:(0,l._)({},c)}},d=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let a,n=e.find(e=>o(e,t));if(n)a=[...e.filter(e=>!o(e,n)),(0,r._)((0,l._)({},n),{relatedPackages:[...n.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let l={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};a=[...e.slice(),l]}return a},[]),a=t.reduce((e,t)=>{let a=t.vulnerabilityStatus,n=(0,i.U)(t.vulnerability.average_severity),s=e.vulnerabilityStatus[a];return Object.assign(e,{vulnerabilityStatus:(0,r._)((0,l._)({},e.vulnerabilityStatus),{[a]:{total:s.total+1,severities:(0,r._)((0,l._)({},s.severities),{[n]:s.severities[n]+1})}})})},(0,l._)({},u));return{vulnerabilities:t,summary:a}},h=e=>{let{advisories:t,isFetching:a,fetchError:l}=(0,s.DH)(e);return{data:n.useMemo(()=>d(t||[]),[t]),isFetching:a,fetchError:l}},v=e=>{let{advisories:t,isFetching:a,fetchError:l}=(0,s.zY)(e);return{data:n.useMemo(()=>(null!=t?t:[]).map(e=>d(e||[])),[t]),isFetching:a,fetchError:l}}},98345:function(e,t,a){a.d(t,{f:()=>o});var l=a(62540),r=a(63696),n=a(91242),i=a(4392),s=a(30111);let o=e=>{let{sbom:t,onClose:a}=e,{pushNotification:o}=r.useContext(i.K),[c,u]=r.useState(""),[d,h]=r.useState("");r.useEffect(()=>{let e=setTimeout(()=>{h(c)},400);return()=>clearTimeout(e)},[c]);let{labels:v}=(0,s._P)(d),{mutate:y,isPending:p}=(0,s.cF)(()=>{o({title:"Labels updated for SBOM ".concat(t.name),variant:"success"}),a()},e=>{o({title:"Error while updating labels for SBOM ".concat(t.name),variant:"danger"})});return(0,l.jsx)(n.e,{title:"Labels of SBOM: ".concat(t.name),value:t.labels,isDisabled:p,onSave:e=>{y({id:t.id,labels:e})},onClose:a,onInputChange:u,options:v})}},30111:function(e,t,a){a.d(t,{DH:()=>_,Qr:()=>k,_P:()=>f,bj:()=>q,cF:()=>S,i$:()=>m,l6:()=>j,rj:()=>g,sn:()=>x,zY:()=>w});var l=a(32909),r=a(42642),n=a(72610),i=a(77184),s=a(59722),o=a(62603),c=a(90130),u=a(3822),d=a(96002),h=a(86141),v=a(93531),y=a(81895),p=a(73470);let b="sboms",f=e=>{let{data:t,isLoading:a,error:l,refetch:r}=(0,i.I)({queryKey:[b,"labels",e],queryFn:()=>(0,h.Dw)({client:d.S,query:{limit:10,filter_text:e}}),placeholderData:s.rX});return{labels:(null==t?void 0:t.data)||[],isFetching:a,fetchError:l,refetch:r}},m=function(){var e,t,a;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,p.kd)(s),{q:v}=u,y=(0,n._)(u,["q"]),f=(0,p.Er)(o),{data:m,isLoading:g,error:j,refetch:x}=(0,i.I)({queryKey:[b,s,f],queryFn:()=>(0,h.z1)({client:d.S,query:(0,r._)((0,l._)({},y),{q:[v,f].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==m||null==(e=m.data)?void 0:e.items)||[],total:null!=(a=null==m||null==(t=m.data)?void 0:t.total)?a:0,params:s},isFetching:g,fetchError:j,refetch:x}},g=e=>{let{data:t,isLoading:a,error:l}=(0,i.I)({queryKey:[b,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,h.a7)({client:d.S,path:{id:e}}),enabled:void 0!==e});return{sbom:null==t?void 0:t.data,isFetching:a,fetchError:l}},j=(e,t)=>{let a=(0,o.jE)();return(0,c.n)({mutationFn:async e=>(await (0,h.bS)({client:d.S,path:{id:e}})).data,onSuccess:async(t,l)=>{e(t,l),await a.invalidateQueries({queryKey:[b]})},onError:async e=>{t(e),await a.invalidateQueries({queryKey:[b]})}})},x=()=>{let e=(0,o.jE)();return(0,v.v)({parallel:!0,uploadFn:(e,t)=>(0,y.J4)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[b]})}})},S=(e,t)=>{let a=(0,o.jE)();return(0,c.n)({mutationFn:e=>(0,h.aB)({client:d.S,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await a.invalidateQueries({queryKey:[b]})},onError:t})},k=function(e){var t,a,r;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:s,isLoading:o,error:c,refetch:u}=(0,i.I)({queryKey:[b,"by-package",e,n],queryFn:()=>(0,h.m9)({client:d.S,query:(0,l._)({purl:e},(0,p.kd)(n))})});return{result:{data:(null==s||null==(t=s.data)?void 0:t.items)||[],total:null!=(r=null==s||null==(a=s.data)?void 0:a.total)?r:0,params:n},isFetching:o,fetchError:c,refetch:u}},_=e=>{let{data:t,isLoading:a,error:l}=(0,i.I)({queryKey:[b,e,"advisory"],queryFn:()=>(0,h.bj)({client:d.S,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:a,fetchError:l}},w=e=>{let t=(0,u.E)({queries:e.map(e=>({queryKey:[b,e,"advisory"],queryFn:()=>(0,h.bj)({client:d.S,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},q=e=>{let{data:t,isLoading:a,error:l}=(0,i.I)({queryKey:[b,e,"license-ids"],queryFn:()=>(0,h.ZV)({client:d.S,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:a,fetchError:l}}}}]);